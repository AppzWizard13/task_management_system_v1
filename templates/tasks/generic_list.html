{% extends "index.html" %}
{% load django_bootstrap5 %}
{% load static %}
{% load filter_extras %} {# A custom filter explained below to get attr dynamically #}

{% block title %}{{ page_title }}{% endblock %}

{% block content %}
<div class="row">
  <div class="col-lg-12 d-flex align-items-stretch">
    <div class="card w-100">
      <div class="card-body p-4">
        <h5 class="card-title fw-semibold mb-4">{{ page_title }}</h5>
        {% if add_url %}
        <a href="{% url add_url %}" class="btn btn-primary mb-4">Add {{ item_name }}</a>
        {% endif %}
        <div class="table-responsive">
          <table class="table text-nowrap mb-0 align-middle">
            <thead class="text-dark fs-5">
              <tr>
                <th class="border-bottom-0"><h6 class="fw-semibold mb-0">#</h6></th>
                {% for col in table_headers %}
                <th class="border-bottom-0"><h6 class="fw-semibold mb-0">{{ col }}</h6></th>
                {% endfor %}
                {% if edit_url or delete_url %}
                <th class="border-bottom-0"><h6 class="fw-semibold mb-0">Actions</h6></th>
                {% endif %}
              </tr>
            </thead>
            <tbody>
              {% for obj in object_list %}
              <tr>
                <td class="border-bottom-0"><h6 class="fw-semibold mb-0">{{ forloop.counter }}</h6></td>
                {% for attr in list_attrs %}
                <td class="border-bottom-0">
                  {% if forloop.first and detail_url %}
                  <a href="{% url detail_url obj.pk %}" class="fw-semibold text-decoration-none">{{ obj|attr:attr }}</a>
                  {% else %}
                  {{ obj|attr:attr }}
                  {% endif %}
                </td>
                {% endfor %}
                {% if edit_url or delete_url %}
                <td class="border-bottom-0">
                  {% if edit_url %}
                  <a href="{% url edit_url obj.pk %}" class="btn btn-sm btn-outline-warning">Edit</a>
                  {% endif %}
                  {% if delete_url %}
                  <a href="{% url delete_url obj.pk %}" class="btn btn-sm btn-outline-danger">Delete</a>
                  {% endif %}
                </td>
                {% endif %}
              </tr>
              {% empty %}
              <tr>
                <td colspan="{{ table_headers|length|add:'2' }}" class="text-center fw-normal">No {{ item_name }} found.</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        {% if is_paginated %}
        <nav aria-label="Page navigation" class="mt-3">
          <ul class="pagination justify-content-center mb-0">
            {% if page_obj.has_previous %}
            <li class="page-item">
              <a class="page-link" href="?page={{ page_obj.previous_page_number }}">&laquo; Previous</a>
            </li>
            {% else %}
            <li class="page-item disabled"><span class="page-link">&laquo; Previous</span></li>
            {% endif %}
            <li class="page-item disabled">
              <span class="page-link">Page {{ page_obj.number }} of {{ paginator.num_pages }}</span>
            </li>
            {% if page_obj.has_next %}
            <li class="page-item">
              <a class="page-link" href="?page={{ page_obj.next_page_number }}">Next &raquo;</a>
            </li>
            {% else %}
            <li class="page-item disabled"><span class="page-link">Next &raquo;</span></li>
            {% endif %}
          </ul>
        </nav>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
